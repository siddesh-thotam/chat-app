{% load static %}
{% load django_htmx %}
<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Real-Time Chat Application">
    <title>Real-Time Chat App</title>
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://unpkg.com/htmx.org@2.0.2"></script>
    <script src="https://unpkg.com/htmx.org/dist/htmx.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    {% django_htmx_script %}
    <script src="https://unpkg.com/hyperscript.org@0.9.14"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style type="text/tailwindcss">
        [x-cloak] { 
            display: none !important; 
        }
        
        /* Dark theme base */
        body {
            @apply bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 min-h-screen text-white;
        }
        
        /* Typography */
        h1 {
            @apply text-4xl font-bold mb-6 bg-gradient-to-r from-red-400 to-red-600 bg-clip-text text-transparent;
        }
        h2 {
            @apply text-2xl font-bold mb-4 text-white;
        }
        h3 {
            @apply text-xl font-bold text-white;
        }
        p {
            @apply mb-4 text-gray-300 leading-relaxed;
        }
        
        /* Enhanced Buttons */
        .button, button, [type='submit'], [type='button'] {
            @apply bg-gradient-to-r from-red-600 to-red-700 text-white font-semibold rounded-xl shadow-lg transition-all duration-300 cursor-pointer border-0 relative overflow-hidden;
        }
        .button, button a, [type='submit'], [type='button'] {
            @apply px-6 py-3 inline-block;
        }
        .button:hover, button:hover, [type='submit']:hover, [type='button']:hover {
            @apply from-red-700 to-red-800 shadow-xl shadow-red-500/25 transform scale-105;
        }
        .button:active, button:active, [type='submit']:active, [type='button']:active {
            @apply scale-95;
        }
        
        /* Button variants */
        .button.alert, button.alert {
            @apply from-red-700 to-red-800;
        }
        .button.alert:hover, button.alert:hover {
            @apply from-red-800 to-red-900;
        }
        .button-red {
            @apply !bg-gradient-to-r !from-red-600 !to-red-700 hover:!from-red-700 hover:!to-red-800 !shadow-red-500/25;
        }
        .button-gray {
            @apply !bg-gradient-to-r !from-gray-600 !to-gray-700 hover:!from-gray-700 hover:!to-gray-800 !shadow-gray-500/25;
        }
        
        /* Navigation */
        .navitems > li > a {
            @apply flex items-center gap-3 h-12 px-4 hover:bg-gray-700/50 rounded-xl transition-all duration-300 text-gray-300 hover:text-white;
        }
        
        /* Lists */
        .hoverlist > * {
            @apply hover:bg-gray-800/80 rounded-lg transition-all duration-300;
        }
        .hoverlist > * > a {
            @apply flex items-center p-3 text-gray-300 hover:text-white;
        }
        
        /* Forms */
        .textarea, textarea, input {
            @apply w-full rounded-xl py-4 px-5 bg-gray-800/80 border border-gray-600 text-white placeholder-gray-400 focus:outline-none focus:border-red-500 focus:ring-2 focus:ring-red-500/20 transition-all duration-300;
        }
        
        input[type=file] {
            @apply bg-gray-800/80 border-gray-600 pl-0;
        }
        
        /* Labels */
        label {
            @apply hidden;
        }
        label[for="id_remember"] {
            @apply inline-block w-auto mr-2 text-gray-300;
        }
        input[name="remember"] {
            @apply w-auto;
        }
        
        /* Error lists */
        .errorlist li {
            @apply p-3 pl-4 border-l-red-500 border-l-4 border-solid mb-2 text-red-400 bg-red-900/20 rounded-r-lg;
        }
        
        /* Alerts */
        .alert-info { @apply bg-gradient-to-r from-blue-600 to-blue-700; }
        .alert-success { @apply bg-gradient-to-r from-green-600 to-green-700; }
        .alert-warning { @apply bg-gradient-to-r from-yellow-600 to-yellow-700; }
        .alert-danger { @apply bg-gradient-to-r from-red-600 to-red-700; }
        
        /* Status dots */
        .green-dot {
            @apply rounded-full bg-green-500 p-1.5 shadow-lg shadow-green-500/50;
        }
        .gray-dot {
            @apply rounded-full bg-gray-500 p-1.5;
        }
        .graylight-dot {
            @apply rounded-full bg-gray-300 p-1.5;
        }
        
        /* Highlight */
        .highlight {
            @apply !bg-red-900/30 !border-red-500/50;
        }
        
        /* Allauth specific */
        .allauth content a {
            @apply underline underline-offset-2 text-red-400 hover:text-red-300;
        }
        .allauth form[action="/accounts/signup/"] ul {
            @apply hidden;
        }
        .allauth form[action="/accounts/signup/"] ul.errorlist {
            @apply block;
        }
        .allauth .helptext {
            @apply block mt-4 text-gray-400;
        }
        
        /* Animation keyframes */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(239, 68, 68, 0.5); }
            50% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.8); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(2deg); }
        }
        
        @keyframes pulse-slow {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        .animate-glow {
            animation: glow 2s ease-in-out infinite;
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        .animate-pulse-slow {
            animation: pulse-slow 3s ease-in-out infinite;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(31, 41, 55, 0.5);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(239, 68, 68, 0.6);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(239, 68, 68, 0.8);
        }
        
        /* Glassmorphism effects */
        .glass {
            @apply backdrop-blur-xl bg-white/10 border border-white/20;
        }
        .glass-dark {
            @apply backdrop-blur-xl bg-gray-900/80 border border-gray-700/50;
        }
        
        /* Button shimmer effect */
        .button::before, button::before, [type='submit']::before, [type='button']::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }
        .button:hover::before, button:hover::before, [type='submit']:hover::before, [type='button']:hover::before {
            left: 100%;
        }
    </style>
</head>
<body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}' class="{% block class %}{% endblock %}">
    
    <!-- Animated background particles -->
    <div id="background-particles" class="fixed inset-0 pointer-events-none -z-10">
        <!-- Particles will be generated by JavaScript -->
    </div>
    
    {% include 'includes/messages.html' %}
    {% include 'includes/header.html' %}

    {% block layout %}
    {% endblock %}
    
    

    <!-- Global JavaScript -->
    <script>
        // Background particles animation
        function initBackgroundParticles() {
            const container = document.getElementById('background-particles');
            if (!container) return;
            
            // Create floating particles
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'absolute rounded-full opacity-20';
                
                // Random size and color
                const size = Math.random() * 4 + 2;
                const isRed = Math.random() > 0.5;
                
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.backgroundColor = isRed ? '#ef4444' : '#6b7280';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                
                container.appendChild(particle);
                
                // Animate with anime.js if available
                if (typeof anime !== 'undefined') {
                    anime({
                        targets: particle,
                        translateY: [0, -100 - Math.random() * 200],
                        translateX: [-50 + Math.random() * 100, -50 + Math.random() * 100],
                        scale: [0.5, 1.5, 0.5],
                        opacity: [0.1, 0.3, 0.1],
                        duration: 8000 + Math.random() * 8000,
                        loop: true,
                        easing: 'easeInOutSine',
                        delay: Math.random() * 4000
                    });
                }
            }
        }
        
        // Initialize on DOM load
        document.addEventListener('DOMContentLoaded', function() {
            initBackgroundParticles();
            
            // Add loading animation to buttons
            document.querySelectorAll('button, .button, [type="submit"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (!this.disabled) {
                        this.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            this.style.transform = '';
                        }, 150);
                    }
                });
            });
        });
        
        // HTMX loading indicators
        document.addEventListener('htmx:beforeRequest', function(e) {
            const target = e.target;
            if (target.tagName === 'BUTTON' || target.type === 'submit') {
                target.disabled = true;
                target.innerHTML = '<svg class="animate-spin w-4 h-4 mr-2 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>Loading...';
            }
        });
        
        document.addEventListener('htmx:afterRequest', function(e) {
            const target = e.target;
            if (target.tagName === 'BUTTON' || target.type === 'submit') {
                target.disabled = false;
                // Reset button text (you might want to store original text)
                if (target.innerHTML.includes('Loading...')) {
                    target.innerHTML = 'Submit'; // Default fallback
                }
            }
        });
    </script>

    {% block javascript %}{% endblock %}
</body>
</html>